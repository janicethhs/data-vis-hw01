---
title: "Homework 01"
author: "JANICE IM"
output: github_document
---
```{r set up}
# set default theme for ggplot2
ggplot2::theme_set(ggplot2::theme_minimal(base_size = 16))

```

1.  **Reverse-engineering the grammar of graphics.**

```{r label-me-1}

```

2.  **Road traffic accidents in Edinburgh.**

```{r density graph}
library(dsbox)
library(tidyverse)
# install.packages("remotes")
# remotes::install_github("rstudio-education/dsbox")
accidents
Weekenddata <- accidents %>%
  mutate(daytype = case_when(day_of_week %in% c("Saturday", "Sunday") ~ "Weekend",
                             TRUE ~ "Weekday")) %>%

ggplot(Weekenddata, aes(x = time, fill = severity)) +
  scale_fill_brewer(palette = "Set3") +
  geom_density() +
  facet_grid(rows = "daytype") +
  labs(title = "Number of accidents per day", x = "Time of day", y = "Density", subtitle = "By day of week and severity")
# Check color palettes using RColorBrewer::display.brewer.all()
```

3.  **NYC marathon winners.**
```{r marathon}
library(openintro)
#install.packages("openintro")

# PART A- A Histogram and box plot
nyc_marathon

### Histogram
ggplot(nyc_marathon, aes(x = time_hrs)) +
  geom_histogram(binwidth = .05) +
  labs(title = "Marathon times of NYC runners", x = "Time (hrs)", y = "Number of NYC runners")

### Boxplot
ggplot(nyc_marathon, aes(x = time_hrs)) +
  geom_boxplot() +
  coord_flip() +
  labs(title = "Marathon times of NYC runners", x = "Time (hrs)")


# PART B- A Box plot for men and women
ggplot(nyc_marathon, aes(x = time_hrs, fill = division)) + 
  geom_boxplot() +
  coord_flip() +
  scale_fill_discrete(type = c("Blue", "Red")) +
  labs(title = "Marathon times of men and women NYC runners", x = "Time (hrs)")


# PART C- Frequency polygon to avoid redundant information from the box plot
ggplot(nyc_marathon, aes(x = time_hrs, color = division)) +
  geom_freqpoly(binwidth = .1, size = 1) +
  xlim(1,4) +
  labs(title = "Marathon times of men and women NYC runners", x = "Time (hrs)", y= "Number of runners")


# PART D- Visualizing the marathon times of men and women over the years
ggplot(nyc_marathon, aes(x = year, y = time_hrs, color = division)) + 
  geom_smooth() +
  scale_fill_discrete(type = c("Blue", "Red")) +
  labs(title = "Marathon times of NYC runners over the years", x = "Year", x = "Year", y = "Time (hrs)")

```
4.  **US counties.**
`

5.  **Napoleonâ€™s march.**